# power-automate-explanatory-materials
![PA開発したフロー説明](https://github.com/user-attachments/assets/3196a2c1-b942-46ff-98af-a28e443d3adb)

```

【実務でのPowerAutomateクラウド開発経緯】
※前提条件　Microsoft　office　365ビジネス利用　
コロナ対応窓口のフローを引き継ぎ、DX推進の方よりPowerAutomateの基本を教えて頂きました。
そこで、勉強のみならず過去に社内利用していたintra-martの申請やお問合せをPowerAutomateで自動化するプロジェクトを実現しました。

【要件について】
最低現欲しい機能を要件で聞きました。
Formsを使用する、Excelファイルでメールアドレスを管理する、お問合せを処理する担当者にメール送信が必要。

【工夫した点について】
実際の運用を考えた時にExcelでお問合せを共有する、本文にリンクを挿入して、HTML形式で記述しtarget属性を採用する
様々な部署と従業員にお問合せをしてもらうためにFormsの添付ファイル制限なしで
Word、Excel、PPT、PDF、画像、ビデオ、オーディオを添付してもメール送信されるように開発。
TeamsのメンションもHTML形式で<at>タグでメンションするようにエラーメッセージを通知する。
Excel onlineで問合せを管理していく中で、フィルターをしたまま保存されるとフローがテーブル行に挿入出来ないため失敗することがありました。
実行失敗してもメール送信が可能になるように開発。
Excelのお問合せ文章がセルから見切れることがほとんどだったため、
Officeスクリプト「プログラミング言語としてJavaScript（TypeScript）」で
テーブル行の高さを自動調整するコードとボタンも設置していました。
サンプルをコード
function main(workbook: ExcelScript.Workbook) {
workbook.getWorksheet(シート名).getRange(行).getFormat().autofitRows();
}
セルをダブルクリックすると調整してくれる実装です。
Excelにデータが溜まるので、COUNTIF関数で集計が自動で行われる、
データが自動で追加、追加されたデータも自動で集計を実現しました。
これにより、何のお問合せが何件あったのか集計する時間は必要なくなりました。

アクション数が多いので、スコープアクションも複数設定しました。
要望として、退職してしまった方のメール送信が行われると開発者あてに配信不能メールをMicrosoftより受信する仕組みがあり、
メールアドレスを管理しているExcelファイルを確認するように
アナウンスをExcel管理担当者にメール送信するフローも使用していました。

【運用の効果について】
社内展開している期間は半年足らずですが、お問合せの件数は400件超えていました。
お問合せとWi-Fi貸出など申請も可能になっています。
intra-martで運用していた時より汎用性、効率化がかなり進みました。
これがDXの力と私ながら驚きました。

【PowerAutomate Desktopの実務経験】
社内で社員マスタを使用していて、他の業務でも更新が必要になっていきました。
そこで、PADを使用してWEB上Excelのマクロを9時になったら実行し、
更新を自動化、ダウンロードして日付にリネームし所定のフォルダに自動で移動するフローも依頼があり開発と運用をしていました。
ほぼ手作業がなく1分以内で完了していました。

```
